



<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Claim Worker Pay</title>

    <!-- CSS -->
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css' rel='stylesheet'>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href='../../_static/main.css' rel='stylesheet'>
    <link href='../../_static/style.css' rel='stylesheet'>
    <link href='../../_static/doxygen.css' rel='stylesheet'>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />

    <!-- Sphinx search -->
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <script type="text/javascript" src="searchindex.js.html"></script>
    <!-- Transifex -->
    <script type="text/javascript">
      window.liveSettings = {
        api_key: "bbf87af0641e4bbf89c98088d48e0449",
      };
    </script>
    <script type="text/javascript" src="http://cdn.transifex.com/live.js"></script>

    <!-- title card -->
    <link  href='../../_static/title-card.css' rel='stylesheet'>
    <script src='../../_static/script.js'></script>
    
    <!-- Sphinx search -->
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Graphene Technical Documentation  documentation"
          href="../../_static/opensearch.xml.html"/>

    <!-- Meta -->
    <meta content="Graphene Documentation" property="og:site_name">
    <meta content="Graphene Documentation" property="og:title">
    <meta content="website" property="og:type">
    <meta content="Graphene Documentation" name="description">
    <meta content="Graphene Documentation" property="og:description">
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68381245-1', 'auto');
  ga('send', 'pageview');

</script>

 
<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="worker-budget.html" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'bitshares/tutorials/worker-budget' 		
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="../../_static/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> -->
</head>
 <body class='no-literate'>


 <div class='title-area title-card' style='background-image: url("https://bitshares.org/images/bg.jpg")'>
   <div class='in'>
     <div class='headline'>
       <h1>Claim Worker Pay</h1>
 
     </div>
   </div>
 </div>

 <div class='header'>
   <div class='left navlinks'>
    
        <div class="prev">
         <div class="title">previous</div>
         <span><a href="worker-create.html">How to Create a Worker</a></span>
        </div>
        <div class="top">
         <div class="title">top</div>
         <span><a class="uplink" href="../../index.html">Contents</a></span>
        </div>
        <div class="next">
         <div class="title">next</div>
         <span><a href="witness-howto.html">Howto Run a Block-producing Witness</a></span>
        </div>

   </div>
 </div>

 <div class='content-root'>
  <!-- menu bar -->
  <div class='menubar'>
   <div class='section'>
    <a href="../../index.html"><img src="../../_static/grphn-logo.svg" height="48" /></a>
    <a href="../index.html"><img src="../../_static/bitshares-logo.png" height="48" /></a>
    <a href="../../muse/index.html"><img src="../../_static/MUSE_logo_transp_v1.png" height="48" /></a>
   </div>
   <div class='menu section'>
    <div id="toc">
      <h3>Table Of Contents</h3>
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">BitShares 2.0</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#what-is-bitshares">What is BitShares</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#guides">Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../migration/index.html">Migrating from BitShares 1.0 to BitShares 2.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/index.html">User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../investor/index.html">Investor Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developers/index.html">Businesses, Developers and Business Developers</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#general-tutorials">General Tutorials</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#api-usage">API Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#assets">Assets</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#prediction-markets">Prediction Markets</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#committee-tutorials">Committee Tutorials</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#worker-tutorials">Worker Tutorials</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="worker-create.html">How to Create a Worker</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="worker-budget.html#">Claim Worker Pay</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="index.html#witness-tutorials">Witness Tutorials</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#developers">Developers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../muse/index.html">MUSE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../integration/index.html">Integration Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testnet/index.html">Testnets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../meta/index.html">How to Contribute</a></li>
</ul>

    </div>
   </div>
   <div class="search section">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
   </div>
   <div class='bottom section'>
    <p class="centered">
     This page is proudly presented by <br />
     <a href="http://chainsquad.com">ChainSquad GmbH</a>
    </p>
    <p class="centered">
     <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
    </p>
   </div>
  </div>
  <div class='content'>
   
  <div class="section" id="claim-worker-pay">
<h1>Claim Worker Pay<a class="headerlink" href="worker-budget.html#claim-worker-pay" title="Permalink to this headline">¶</a></h1>
<p>Every second, <cite>[ 17/(2^32) * reserve fund ]</cite> is allocated for witnesses and
workers where reserve fund is how many BTS are currently not distributed (see
the <a class="reference external" href="https://github.com/cryptonomex/graphene/blob/f85dec1c23f6bf9259ad9f15311b2e4aac4f9d44/libraries/chain/include/graphene/chain/config.hpp">source code</a>).</p>
<p>Every hour the total available reserve fund is calculated by finding how many
BTS are available to be distributed and how many BTS will be returned to the
reserve fund (i.e., “burnt”) during the next maintenance interval.</p>
<p>First find how many BTS have not been distributed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># get max_supply from</span>
<span class="n">get_object</span> <span class="mf">1.3</span><span class="o">.</span><span class="mi">0</span>
<span class="c1"># get current_supply from</span>
<span class="n">get_object</span> <span class="mf">2.3</span><span class="o">.</span><span class="mi">0</span>

<span class="o">==&gt;</span> <span class="n">from_initial_reserve</span> <span class="o">=</span> <span class="n">max_supply</span> <span class="o">-</span> <span class="n">current</span> <span class="n">supply</span> <span class="n">of</span> <span class="n">BTS</span>
</pre></div>
</div>
<p>Then modify it by adding the accumulated fees and witness budget remaining
(i.e., 1.5 BTS per block is budgeted, so budget remaining is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.5</span> <span class="n">BTS</span> <span class="o">*</span> <span class="p">(</span><span class="n">number</span> <span class="n">of</span> <span class="n">blocks</span> <span class="n">left</span> <span class="ow">in</span> <span class="n">maintenance</span> <span class="n">period</span><span class="o">+</span><span class="n">blocks</span> <span class="n">missed</span> <span class="n">by</span> <span class="n">witnesses</span><span class="p">))</span>
</pre></div>
</div>
<p>in this maintenance cycle (they will be added to the “reserve fund” permanently
at maintenance)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">get_object</span> <span class="mf">2.13</span><span class="o">.*</span>

<span class="o">==&gt;</span> <span class="n">updated</span> <span class="n">reserve</span> <span class="n">fund</span> <span class="o">=</span> <span class="n">from_initial_reserve</span> <span class="o">+</span>  <span class="n">from_accumulated_fees</span> <span class="o">+</span> <span class="n">from_unused_witness_budget</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_object</span> <span class="mf">2.13</span><span class="o">.</span><span class="mi">361</span>
<span class="go">get_object 2.13.361</span>
<span class="go">[{</span>
<span class="go">    &quot;id&quot;: &quot;2.13.361&quot;,</span>
<span class="go">    &quot;time&quot;: &quot;2015-10-28T15:00:00&quot;,</span>
<span class="go">    &quot;record&quot;: {</span>
<span class="go">      &quot;time_since_last_budget&quot;: 3600,</span>
<span class="go">      &quot;from_initial_reserve&quot;: &quot;106736452914941&quot;,</span>
<span class="go">      &quot;from_accumulated_fees&quot;: 15824269,</span>
<span class="go">      &quot;from_unused_witness_budget&quot;: 2250000,</span>
<span class="go">      &quot;requested_witness_budget&quot;: 180000000,</span>
<span class="go">      &quot;total_budget&quot;: 1520913100,</span>
<span class="go">      &quot;witness_budget&quot;: 180000000,</span>
<span class="go">      &quot;worker_budget&quot;: 1340913100,</span>
<span class="go">      &quot;leftover_worker_funds&quot;: 0,</span>
<span class="go">      &quot;supply_delta&quot;: 1502838831</span>
<span class="go">    }</span>
<span class="go">  }</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Then calculate how much is available to be spent on workers and witnesses is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">total_budget</span> <span class="o">=</span> <span class="p">(</span><span class="n">updated</span> <span class="n">reserve</span> <span class="n">fund</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">time_since_last_budget</span><span class="p">)</span><span class="o">*</span><span class="mi">17</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">32</span><span class="p">)</span>  <span class="c1">#rounded up to the nearest integer</span>
</pre></div>
</div>
<p>Ok, now to find how much workers will get in this budget period (1 hour), you
find the smaller of the available pay AFTER subtracting witness budget from the
total_budget OR the worker_budget_per_day/24 from “get_global_properties”</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">worker_budget</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">total_budget</span><span class="o">-</span><span class="n">witness_budget</span><span class="p">,</span><span class="n">worker_budget_per_day</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>That is how much per hour allocated for all workers. NOW you rank each worker
and pay them one hours worth of pay in order or # votes.</p>
<div class="section" id="references">
<h2>References:<a class="headerlink" href="worker-budget.html#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/cryptonomex/graphene/blob/4c09d6b8ed350ff5c7546e2c3fd15d0e6699daf2/libraries/chain/db_maint.cpp">https://github.com/cryptonomex/graphene/blob/4c09d6b8ed350ff5c7546e2c3fd15d0e6699daf2/libraries/chain/db_maint.cpp</a></p>
</div>
</div>


  </div>
 </div>

 <script>var HN=[];HN.factory=function(e){return function(){HN.push([e].concat(Array.prototype.slice.call(arguments,0)))};},HN.on=HN.factory("on"),HN.once=HN.factory("once"),HN.off=HN.factory("off"),HN.emit=HN.factory("emit"),HN.load=function(){var e="hn-button.js";if(document.getElementById(e))return;var t=document.createElement("script");t.id=e,t.src="//hn-button.herokuapp.com/hn-button.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},HN.load();</script>
 <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
 </body>
</html>