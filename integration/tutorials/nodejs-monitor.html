



<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>NodeJS Example</title>

    <!-- CSS -->
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css' rel='stylesheet'>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href='../../_static/main.css' rel='stylesheet'>
    <link href='../../_static/style.css' rel='stylesheet'>
    <link href='../../_static/doxygen.css' rel='stylesheet'>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />

    <!-- Sphinx search -->
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <script type="text/javascript" src="searchindex.js.html"></script>
    <!-- Transifex -->
    <script type="text/javascript">
      window.liveSettings = {
        api_key: "bbf87af0641e4bbf89c98088d48e0449",
      };
    </script>
    <script type="text/javascript" src="http://cdn.transifex.com/live.js"></script>

    <!-- title card -->
    <link  href='../../_static/title-card.css' rel='stylesheet'>
    <script src='../../_static/script.js'></script>
    
    <!-- Sphinx search -->
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Graphene Technical Documentation  documentation"
          href="../../_static/opensearch.xml.html"/>

    <!-- Meta -->
    <meta content="Graphene Documentation" property="og:site_name">
    <meta content="Graphene Documentation" property="og:title">
    <meta content="website" property="og:type">
    <meta content="Graphene Documentation" name="description">
    <meta content="Graphene Documentation" property="og:description">
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68381245-1', 'auto');
  ga('send', 'pageview');

</script>

 
<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="nodejs-monitor.html" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'integration/tutorials/nodejs-monitor' 		
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="../../_static/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> -->
</head>
 <body class='no-literate'>


 <div class='title-area title-card' style='background-image: url("https://bitshares.org/images/bg.jpg")'>
   <div class='in'>
     <div class='headline'>
       <h1>NodeJS Example</h1>
 
     </div>
   </div>
 </div>

 <div class='header'>
   <div class='left navlinks'>
    
        <div class="top">
         <div class="title">top</div>
         <span><a class="uplink" href="../../index.html">Contents</a></span>
        </div>

   </div>
 </div>

 <div class='content-root'>
  <!-- menu bar -->
  <div class='menubar'>
   <div class='section'>
    <a href="../../index.html"><img src="../../_static/grphn-logo.svg" height="48" /></a>
    <a href="../../bitshares/index.html"><img src="../../_static/bitshares-logo.png" height="48" /></a>
    <a href="../../muse/index.html"><img src="../../_static/MUSE_logo_transp_v1.png" height="48" /></a>
   </div>
   <div class='menu section'>
    <div id="toc">
      <h3>Table Of Contents</h3>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../../bitshares/index.html">BitShares 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../muse/index.html">MUSE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Integration Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testnet/index.html">Testnets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../meta/index.html">How to Contribute</a></li>
</ul>

    </div>
   </div>
   <div class="search section">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
   </div>
   <div class='bottom section'>
    <p class="centered">
     This page is proudly presented by <br />
     <a href="http://chainsquad.com">ChainSquad GmbH</a>
    </p>
    <p class="centered">
     <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
    </p>
   </div>
  </div>
  <div class='content'>
   
  <div class="section" id="nodejs-example">
<h1>NodeJS Example<a class="headerlink" href="nodejs-monitor.html#nodejs-example" title="Permalink to this headline">¶</a></h1>
<p>This nodejs script monitors the balance history of an account in a
graphene-based network such as BitShares 2.0.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="nodejs-monitor.html#installation" title="Permalink to this headline">¶</a></h2>
<p>A NodeJS library to monitor incoming transactions can be downloaded from</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>git clone https://github.com/xeroc/node-graphene-monitor
<span class="nb">cd</span> node-graphene-monitor
npm install
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="nodejs-monitor.html#configuration" title="Permalink to this headline">¶</a></h2>
<p>To make use of this library, we can instruct any full-node to send
notifications for all incoming transactions for any account. Let’s discuss the
following example script in more details:</p>
<p>We first prepare our variables and import all required modules</p>
<p>Define the <cite>accountID</cite> and the <cite>memo_wif_key</cite>.
The accountID can be obtained from the GUI wallet, or by issuing::</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_account</span> <span class="o">&lt;</span><span class="n">accountname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If the script exists abnormally, you can continue operations by setting
<cite>last_op</cite> to the last operation id that you have captured before the
abnormal exit.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The current implementation has a maxium history size of 100
transaction. If you have missed more than 100 transaction with the
current implementation, manual fixing is required.</p>
</div>
<p>The settings are located in <cite>config.js</cite> and take</p>
<blockquote>
<div><ul class="simple">
<li>the rpc connection settings</li>
<li>the memo decoding private key in wif format</li>
<li>the account ID to monitor</li>
<li>the last operation that has been logged successfully in your backed in case
of ungraceful shutdown</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The last operation will show a maximum of 100 most recent
transactions. If more have been missed due to a down-time. Manual
intervention is necessary.</p>
</div>
<p>Furthermore, in Graphene, memos are usually encrypted using a distinct memo
key. That way, exposing the memo private key will only expose transaction memos
(for that key) and not compromise any funds. It is thus safe to store the memo
private key in 3rd party services and scripts. The memo public key can be
obtained from the account settings or via command line::</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_account</span> <span class="o">&lt;</span><span class="n">myaccount</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>in the cli wallet. The corresponding private key can be obtain from::</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dump_private_keys</span>
</pre></div>
</div>
<p>Note that the latter command exposes all private keys in clear-text wif.</p>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="nodejs-monitor.html#running" title="Permalink to this headline">¶</a></h2>
<p>The script can be executed simply by</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>npm start
</pre></div>
</div>
<p>and will show all incoming transactions and corresponding (decoded) memo.</p>
</div>
</div>


  </div>
 </div>

 <script>var HN=[];HN.factory=function(e){return function(){HN.push([e].concat(Array.prototype.slice.call(arguments,0)))};},HN.on=HN.factory("on"),HN.once=HN.factory("once"),HN.off=HN.factory("off"),HN.emit=HN.factory("emit"),HN.load=function(){var e="hn-button.js";if(document.getElementById(e))return;var t=document.createElement("script");t.id=e,t.src="//hn-button.herokuapp.com/hn-button.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},HN.load();</script>
 <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
 </body>
</html>